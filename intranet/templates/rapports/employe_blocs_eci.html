{% extends "base.html" %}
{% block title %}Rapports{% endblock title %}
{% block extrahead %}
<link rel="stylesheet" href="{{STATIC_URL}}css\datepicker.css" />
<script type="text/javascript" src="{{STATIC_URL}}js/bootstrap-datepicker.js"></script>
{% endblock extrahead %}
{% block jquery %}
$( "#datepicker1" ).datepicker({format: 'yyyy-mm-dd', autoclose: true});
$( "#datepicker2" ).datepicker({format: 'yyyy-mm-dd', autoclose: true});
{% endblock jquery %}
{% block nav-rapport %}<li class="dropdown active">{% endblock nav-rapport %}
{% block content %}
<div class="row-fluid well">
	<div class="span12">
		<form class="form-inline" action="" method="post">{% csrf_token %}
			<p>Affichez les blocs de temps de l'intervalle suivant:</p>
			<p><label for="datepicker1">Date début:</label>
			<input class="input-small" id="datepicker1" type="text" name="date_debut" />
			<label for="datepicker2"> Date fin:</label>
			<input class="input-small" type="text" name="date_fin" id="datepicker2" value="{{ date }}" />
			<input class="btn" type="submit" value="Rechercher" /></p>
			{% if form.errors %}
			<p>Vous n'avez pas remplie les champs correctement</p>
			{% endif %}
		</form>
	</div>
</div>		
<div class="row-fluid well">
	<div class="span12">
	<h4>Rapport de temps {% if date_debut != null %}du {{date_debut}} au {{date_fin}}{% endif %}</h4>
		<table class="table table-striped table-bordered table-condensed">
			<thead>
				<tr>
					<td class="align-right" colspan='5'>
						<a class='btn btn-primary' href="print">Imprimer</a> 
						<a class='btn btn-primary' href="xls">.xls</a>
					</td>
				</tr>
				<tr>
					<th>Date</th>
					<th>Employé</th>
					<th>Numéro de projet</th>
					<th>Tâche</th>
					<th>Temps</th>
				</tr>
			</thead>
			<tfoot>
				<tr>
					<td colspan='3'></td><th>Total:</th><th>{{total_bloc.heures}}</th>
				</tr>
				<tr>
					<td class="align-right" colspan='5'>
						<a class='btn btn-primary' href="print">Imprimer</a> 
						<a class='btn btn-primary' href="xls">.xls</a>
					</td>
				</tr>
			</tfoot>
			<tbody>
		{% for bloc in blocs %}
			<tr>
			<td>{{bloc.date}}</td>
			<td><a href="{% url 'employe_details_eci' bloc.employe.user.username %}">{{bloc.employe.user.first_name}} {{bloc.employe.user.last_name}}</a></td>
			<td><a href="{% url 'projet_details_eci' bloc.projet.numero %}">{{bloc.projet.numero}} {{bloc.projet.nom}} {{bloc.projet.modele}}</a></td>
			<td><a href="{% url 'tache_details_eci' bloc.tache.numero %}">{{bloc.tache.numero}} {{bloc.tache.description}}</a></td>
			<td>{{bloc.temps}}</td>
			</tr>
		{% endfor %}
		</tbody>
		</table>
	</div>
</div>	
{% endblock content %}
