{% extends "base.html" %}
{% block title %}Rapports{% endblock title %}
{% block extrahead %}
<link rel="stylesheet" href="{{STATIC_URL}}css\datepicker.css" />
<script type="text/javascript" src="{{STATIC_URL}}js/bootstrap-datepicker.js"></script>
{% endblock extrahead %}
{% block jquery %}
$( "#datepicker1" ).datepicker({format: 'yyyy-mm-dd', autoclose: true});
$( "#datepicker2" ).datepicker({format: 'yyyy-mm-dd', autoclose: true});
{% endblock jquery %}
{% block nav-eci %}<li class="dropdown active">{% endblock nav-eci %}
{% block content %}
<div class="row-fluid well">
	<div class="span12">
		<form class="form-inline" action="" method="post">{% csrf_token %}
			<p>Affichez les blocs de temps de l'intervalle suivant:</p>
			<p><label for="datepicker1">Date début:</label>
			<input class="input-small" id="datepicker1" type="text" name="date_debut" />
			<label for="datepicker2"> Date fin:</label>
			<input class="input-small" type="text" name="date_fin" id="datepicker2" value="{{ date }}" />
			<input class="btn" type="submit" value="Rechercher" /></p>
			{% if form.errors %}
			<p>Vous n'avez pas remplie les champs correctement</p>
			{% endif %}
		</form>
	</div>
</div>		
<div class="row-fluid well">
	<div class="span12">
		<table class="table table-striped table-bordered table-condensed">
			<caption>Rapport de temps {% if date_debut != null %}du {{date_debut}} au {{date_fin}}{% endif %}</caption>
			<thead>
				<tr>
					<th>Date</th>
					<th>Employé</th>
					<th>Numéro de projet</th>
					<th>Tâche</th>
					<th>Temps</th>
				</tr>
			</thead>
			<tfoot>
				<tr>
					<td colspan='3'></td><th>Total:</th><td>{{total.total}}</td>
				</tr>
				<tr>
					<td colspan='5'><a href='getcsv'>Télécharger .xls</a></td>
				</tr>
			</tfoot>
			<tbody>
		{% for f in blocs %}
			<tr>
			<td>{{f.date}}</td>
			<td><a href="{% url 'feuilledetemps.views.employe_sommaire' f.employe__user__username %}">{{f.employe__user__first_name}} {{f.employe__user__last_name}}</a></td>
			<td><a href="{% url 'feuilledetemps.views.rapportdetail' f.projet__numero %}">{{f.projet__numero}} {{f.projet__nom}} {{f.projet__modele}}</a></td>
			<td><a href="{% url 'feuilledetemps.views.tachedetail' f.tache__numero %}">{{f.tache__numero}} {{f.tache__description}}</a></td>
			<td>{{f.temps}}</td>
			</tr>
		{% endfor %}
		</tbody>
		</table>
	</div>
</div>	
{% endblock content %}
